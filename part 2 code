import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;
import java.util.Scanner;
import org.json.JSONObject;

public class ClimateDetectionApp {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        String apiKey = "55e287914a65ddf929509bdaba96eb99"; // your API key

        while (true) {
            System.out.print("\nEnter city name: ");
            String city = scanner.nextLine().trim();

            try {
                String urlString = "https://api.openweathermap.org/data/2.5/weather?q=" 
                                    + city + "&appid=" + apiKey + "&units=metric";

                URL url = new URL(urlString);
                HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                conn.setRequestMethod("GET");

                BufferedReader reader = new BufferedReader(
                        new InputStreamReader(conn.getInputStream())
                );
                StringBuilder response = new StringBuilder();
                String line;

                while ((line = reader.readLine()) != null) {
                    response.append(line);
                }
                reader.close();

                JSONObject obj = new JSONObject(response.toString());

                // Parse weather info
                String cityName = obj.getString("name");
                double temperature = obj.getJSONObject("main").getDouble("temp");
                double humidity = obj.getJSONObject("main").getDouble("humidity");
                String weatherCondition = obj.getJSONArray("weather").getJSONObject(0).getString("main");

                // Display formatted report
                System.out.println("\n===============================");
                System.out.println("      ?? Weather Report ??");
                System.out.println("===============================");
                System.out.println("City:             " + cityName);
                System.out.println("Temperature:      " + temperature + " Â°C");
                System.out.println("Humidity:         " + humidity + " %");
                System.out.println("Weather Condition:" + weatherCondition);
                System.out.println("===============================\n");

            } catch (Exception e) {
                System.out.println("Error retrieving weather data: " + e.getMessage());
            }

            System.out.print("Do you want to check another city? (yes/no): ");
            String answer = scanner.nextLine().trim().toLowerCase();
            if (!answer.equals("yes")) {
                System.out.println("Thank you for using the Climate Detection Application!");
                break;
            }
        }

        scanner.close();
    }
}
